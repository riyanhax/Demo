!function(t,o,a){function r(t){for(var o=t[1].todayCount,a=t[0].totalCount.today,r=[],e=0;e<g.length;e++)r.push((2*o[g[e]]/a-.5).toFixed(2));return r}function e(t){for(var o=t[1].todayCount,a=t[0].totalCount.today,r=[],e=0;e<g.length;e++)r.push(Math.floor(o[g[e]]/a*665));return r}function n(t){var o=t[3].weekTrend,a=[],r=[];for(var e in o[0].internal)a.push(e);a=l(a);for(var n=0;n<o.length;n++){for(var i=[],c=o[n][g[n]],s=0;s<a.length;s++)i.push(c[a[s]]);r.push(i)}return{xAxis:a,data:r}}function l(t){for(var o=[],a=0;a<t.length;a++)o.push(new Date(t[a]));o.sort(function(t,o){return t>o});for(var a=0;a<o.length;a++){var r=o[a].getFullYear(),e=i(o[a].getMonth()+1),n=i(o[a].getDate());t[a]=r+"-"+e+"-"+n}return t}function i(t){return t>9?""+t:"0"+t}function c(t,o){for(var a=o[2].todaySize,r=o[1].todayCount,e=0;e<g.length;e++){var n=$($("ol.last")[e]),l=$($("ol.first")[e]),i=0,c=0;0==e?(i=a[g[1]],c=r[g[1]]):1==e?(i=a[g[0]],c=r[g[0]]):(i=a[g[e]],c=r[g[e]]),u(l,{time:1,num:c,type:"count"}),u(n,{time:1,num:i,type:"size"})}var s=new PIXI.Application(700,565,{antialias:!0,backgroundColor:1249574});$(s.view).appendTo($(".chart-right"));var f=new PIXI.Graphics;f.beginFill(2828858,1),f.drawRect(15,120,665,4),f.drawRect(15,254,665,4),f.drawRect(15,390,665,4),f.drawRect(15,525,665,4);var d=new PIXI.ticker.Ticker,t=[{y:120,color:47352,start:0,stop:t[1]||0},{y:254,color:110737,start:0,stop:t[0]||0},{y:390,color:15436545,start:0,stop:t[2]||0},{y:525,color:13778070,start:0,stop:t[3]||0}],h=0;d.stop(),d.add(function(o){for(var a=0;a<t.length;a++)f.beginFill(t[a].color,1),f.drawRect(15,t[a].y,t[a].start,4),t[a].start>=t[a].stop?(t[a].end||h++,t[a].end=!0,t[a].start=t[a].stop,h>=t.length&&d.stop()):t[a].start+=10}),d.start(),f.endFill(),s.stage.addChild(f)}function s(t){function o(t,o,r){var e=new PIXI.ticker.Ticker,n=-.5;e.stop(),e.add(function(l){var i=new PIXI.Graphics;i.lineStyle(5,o),i.arc(241,241,r,-Math.PI/2,Math.PI*n,!1),a.stage.addChild(i),n>=t?e.stop():n+=.05}),e.start()}var a=new PIXI.Application(482,482,{antialias:!0,backgroundColor:1249574});$(a.view).appendTo($(".chart-left")),o(t[1],47352,236),o(t[0],110737,223),o(t[2],15436545,210),o(t[3],13778070,197)}function f(t,o){var a=echarts.init($(".chart-bottom")[0]),r={backgroundColor:"#131126",title:{text:"一周稿件推荐趋势分析",textStyle:{color:"#fff"},left:40,top:40},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},grid:{left:"63",right:"30",bottom:"30",top:"88",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:o,axisLabel:{textStyle:{color:"#fff"}}}],yAxis:[{type:"value",axisLabel:{textStyle:{color:"#fff"}},splitLine:{show:!1}}],series:[{name:"互联网数据",type:"line",stack:"总量",smooth:!0,lineStyle:{normal:{color:"rgb(0, 184, 248)"}},areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(0, 184, 248,0.4)"},{offset:1,color:"rgba(0, 184, 248,0)"}])}},data:t[1],symbol:"none"},{name:"社内稿件数据",type:"line",stack:"总量",smooth:!0,lineStyle:{normal:{color:"rgb(235, 139, 1)"}},areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba( 235, 139, 1,0.4)"},{offset:1,color:"rgba(235, 139, 1,0)"}])}},data:t[0],symbol:"none"},{name:"行为交易数据",type:"line",stack:"总量",smooth:!0,lineStyle:{normal:{color:"rgb(1, 176, 145)"}},areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(1, 176, 145,0.4)"},{offset:1,color:"rgba(1, 176, 145,0)"}])}},data:t[2],symbol:"none"},{name:"第三方数据",type:"line",stack:"总量",smooth:!0,lineStyle:{normal:{color:"rgb(210, 60, 150)"}},areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(210, 60, 150,0.4)"},{offset:1,color:"rgba(210, 60, 150,0)"}])}},data:t[3],symbol:"none"}]};a.setOption(r)}function d(t,o){o=o||{};var r,e=$(t),n=o.time,l=o.num,i=16*l/(1e3*n),c=0,s=0;r=setInterval(function(){(c+=i)>=l&&(clearInterval(r),r=a,c=l);var t=Math.floor(c);t!=s&&(s=p(t),e.text(s))},16)}function u(t,o){o=o||{};var r,e=$(t),n=o.time,l=o.num,c=16*l/(1e3*n),s=0,f=0;r=setInterval(function(){(s+=c)>=l&&(clearInterval(r),r=a,s=l);var t=Math.floor(s);if(t!=f){f=t;var n;switch(o.type){case"size":n=i(f.toFixed(2));break;case"count":f=p(f),n=h(f)}for(var d=0;d<n.length;d++)$(e.find("li")[d]).text(n.charAt(d))}},16)}function h(t){if(t.length>5)return t;for(;t.length<=5;)t="0"+t;return t=t.substr(0,2)+","+t.substr(3)}function p(t){t=t.toString();return t.replace(/^(\d+)((\.\d+)?)$/,function(t,o,a){return o.replace(/\d{1,3}(?=(\d{3})+$)/g,"$&,")+a})}var g=["internal","external","records","thirdParty"];$.get(Config.api.api1,function(t){if(200==t.code){t=t.data,console.log(t);var o=n(t);f(o.data,o.xAxis),d(".history-count h1",{time:1,num:1*t[0].totalCount.history}),d(".today-count h1",{time:1,num:1*t[0].totalCount.today});c(e(t),t);s(r(t))}}),function(){var t=new PIXI.Application(561,88,{antialias:!0,backgroundColor:1249574});$(t.view).appendTo($(".loading"));for(var o=[{scale:1,color:47352,x:0,y:0},{scale:.93,color:174049,x:90,y:3},{scale:.86,color:364667,x:175,y:6},{scale:.8,color:360304,x:255,y:8},{scale:.73,color:9722638,x:329,y:12},{scale:.66,color:8343059,x:398,y:15},{scale:.6,color:6169425,x:462,y:15},{scale:.53,color:4988742,x:522,y:18}],a=[],r=0;r<o.length;r++)!function(o,r,e,n){var l=new PIXI.Graphics;l.beginFill(e),l.drawRoundedRect(0,0,70,88,5),l.beginFill(0),l.drawRect(18,22,40,8),l.drawRect(18,40,40,8),l.drawRect(18,57,30,8),l.scale.x=o,l.scale.y=o,l.x=r,l.y=n,l.alpha=0,t.stage.addChild(l),a.push(l)}(o[r].scale,o[r].x,o[r].color,o[r].y);var e=0;!function(t){var o=0;setInterval(function(){if(o+=.05,a[e].alpha=o,o>=1&&(o=0,++e>=7)){e%=7;for(var t=0;t<a.length;t++)a[t].alpha=0}},1e3/60)}()}()}(window,document);