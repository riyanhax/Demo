function chartBottom(t){initTitle(t.obj,t.titleColor,t.title);var e=echarts.init(t.obj.find(".chart").get(0)),a={backgroundColor:"#131126",title:{text:t.title,textStyle:{color:"rgba(255,255,255,0.8)"}},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:t.xAxis||["周一","周二","周三","周四","周五","周六","周日"],axisLine:{lineStyle:{color:"rgba(255,255,255,0.3)"}}}],yAxis:[{type:"value",splitNumber:3,splitLine:{lineStyle:{type:"dashed",color:"rgba(255,255,255,0.3)"}},axisLine:{lineStyle:{color:"rgba(255,255,255,0.3)"}}}],series:[{name:"邮件营销",type:"line",stack:"总量",areaStyle:{normal:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:t.color[0]},{offset:1,color:t.color[1]}],globalCoord:!1}}},lineStyle:{normal:{color:t.color[2]}},data:t.data||[120,132,101,134,90,230,210],showSymbol:!1,smooth:!0}]};e.setOption(a)}function initTitle(t,e,a){var o=t.find(".title"),r=$("<canvas></canvas>");r.attr("width",o.width()),r.attr("height",o.height()),r.appendTo(o),drawTitle(r.get(0).getContext("2d"),e,a)}function drawTitle(t,e,a){var o=t.createLinearGradient(13,36,8,60);o.addColorStop(0,e[0]),o.addColorStop(1,e[1]),t.fillStyle=o,t.rect(13,36,8,24),t.fill(),t.font="20px Microsoft YaHei",t.fillStyle="#fff",t.fillText(a,28,56)}function roseChart(t,e,a){var o=echarts.init(t),r={color:e,tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},visualMap:{show:!1,min:80,max:600,inRange:{colorLightness:[0,1]}},series:[{name:"访问来源",type:"pie",radius:"45%",center:["50%","50%"],data:a||[{value:335,name:"27%"},{value:310,name:"27%"},{value:274,name:"22%"},{value:235,name:"20%"},{value:400,name:"16%"}].sort(function(t,e){return t.value-e.value}),roseType:"angle",label:{normal:{textStyle:{color:"rgba(255, 255, 255, 0.9)",fontSize:36}}},labelLine:{normal:{lineStyle:{color:"rgba(255, 255, 255, 0.9)",type:"dased"},length:50,length2:50}},itemStyle:{normal:{opacity:.9,shadowBlur:200,shadowColor:"rgba(0, 0, 0, 0.5)"}},animationType:"scale",animationEasing:"elasticOut",animationDelay:function(t){return 200*Math.random()}}]};o.setOption(r)}function drawLeftChart(t,e){var a=$("<canvas></canvas>");a.attr("width",t.width()),a.attr("height",t.height()),a.appendTo(t);var o=a.get(0).getContext("2d");drawTitle(o,e.titleColor,e.title);var r=[{type:"稿件",size:22.09},{type:"采编",size:13.02},{type:"落地",size:10.41},{type:"影响力",size:28.23},{type:"数字业务",size:30.45}];r=e.data||r;for(var i=0;i<r.length;i++)!function(t,a){o.beginPath(),o.fillStyle=e.colors[a],o.fillRect(13,118+71*a,125,40),o.fillRect(13,158+71*a,280,2),o.fillStyle="#fff",o.textAlign="left",o.font="22px Microsoft Yahei",o.fillText(t.type,25,145+71*a),o.textAlign="right",o.font="32px Microsoft Yahei",o.fillText(t.size,263,150+71*a),o.font="18px Microsoft Yahei",o.fillText("GB",298,145+71*a)}(r[i],i)}$.get(Config.api.api1,function(t){var e=[],a=[];t.data=t.data;for(var o=0;o<t.data.length;o++)e.push(t.data[o].timeStamp),a.push(t.data[o].storage);chartBottom({obj:$(".chart-left .bottom"),title:"一周趋势",color:["rgba(30,181,254,0.8)","rgba(18,62,45,1)","rgb(30,181,254)"],titleColor:["#14a945","#00b8ea"],xAxis:e,data:a}),chartBottom({obj:$(".chart-right .bottom"),title:"外部数据总量",color:["rgba(163,162,44,0.8)","rgba(69,41,27,1)","rgb(163,162,44)"],titleColor:["#f8d602","#905012"]})}),$.get(Config.api.api2,function(t){for(var e=[],a=0;a<t.data.length;a++)e.push({type:t.data[a].sourceType,size:t.data[a].amount.replace(/GB|MB/,"")});drawLeftChart($(".chart-left .left"),{colors:["#00b8f8","#01b091","#3bb001","#3849d5","#491bbc"],titleColor:["#14a945","#00b8ea"],title:"内部数据总量",data:e}),drawLeftChart($(".chart-right .right"),{colors:["#ecbf00","#eb8b01","#d95701","#c6003d","#d23c96"],titleColor:["#f8d602","#905012"],title:"外部数据总量"})}),$.get(Config.api.api3,function(t){for(var e=[],a=0;a<t.data.length;a++)e.push({value:parseInt(t.data[a].persent)/100*1e3,name:parseInt(t.data[a].persent).toFixed(0)+"%"});console.log(e),e=e.sort(function(t,e){return t.value-e.value}),roseChart($(".chart-left .rose-chart").get(0),["#3849d5","#01b091","#3bb001","#491bbc","#00b8f8"],e),roseChart($(".chart-right .rose-chart").get(0),["#d43b95","#eebf00","#eb8b01","#d95701","#c6003d"])}),initTitle($(".chart-left .top .right"),["#14a945","#00b8ea"],"内部数据分布情况"),initTitle($(".chart-right .top .left"),["#f8d602","#905012"],"外部数据分布情况");