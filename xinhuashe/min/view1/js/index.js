!function(t,o,a){function e(t){for(var o=t[1].todayCount,a=t[0].totalCount.today,e=[],r=0;r<p.length;r++)e.push((2*o[p[r]]/a-.5).toFixed(2));return e}function r(t){for(var o=t[1].todayCount,a=t[0].totalCount.today,e=[],r=0;r<p.length;r++)e.push(Math.floor(o[p[r]]/a*665));return e}function n(t){var o=t[3].weekTrend,a=[],e=[];for(var r in o[0].internal)a.push(r);a=l(a);for(var n=0;n<o.length;n++){for(var i=[],c=o[n][p[n]],s=0;s<a.length;s++)i.push(c[a[s]]);e.push(i)}return{xAxis:a,data:e}}function l(t){for(var o=[],a=0;a<t.length;a++)o.push(new Date(t[a]));o.sort(function(t,o){return t>o});for(var a=0;a<o.length;a++){var e=o[a].getFullYear(),r=i(o[a].getMonth()+1),n=i(o[a].getDate());t[a]=e+"-"+r+"-"+n}return t}function i(t){return t>9?""+t:"0"+t}function c(t,o){for(var a=o[2].todaySize,e=o[1].todayCount,r=0;r<p.length;r++){var n=$($("ol.last")[r]),l=$($("ol.first")[r]),i=0,c=0;0==r?(i=a[p[1]],c=e[p[1]]):1==r?(i=a[p[0]],c=e[p[0]]):(i=a[p[r]],c=e[p[r]]),u(l,{time:1,num:c,type:"count"}),u(n,{time:1,num:i,type:"size"})}var s=new PIXI.Application(700,565,{antialias:!0,backgroundColor:1249574});$(s.view).appendTo($(".chart-right"));var d=new PIXI.Graphics;d.beginFill(2828858,1),d.drawRect(15,120,665,4),d.drawRect(15,254,665,4),d.drawRect(15,390,665,4),d.drawRect(15,525,665,4);var f=new PIXI.ticker.Ticker,t=[{y:120,color:47352,start:0,stop:t[1]||0},{y:254,color:110737,start:0,stop:t[0]||0},{y:390,color:15436545,start:0,stop:t[2]||0},{y:525,color:13778070,start:0,stop:t[3]||0}],g=0;f.stop(),f.add(function(o){for(var a=0;a<t.length;a++)d.beginFill(t[a].color,1),d.drawRect(15,t[a].y,t[a].start,4),t[a].start>=t[a].stop?(t[a].end||g++,t[a].end=!0,t[a].start=t[a].stop,g>=t.length&&f.stop()):t[a].start+=10}),f.start(),d.endFill(),s.stage.addChild(d)}function s(t){function o(t,o,e){var r=new PIXI.ticker.Ticker,n=-.5;r.stop(),r.add(function(l){var i=new PIXI.Graphics;i.lineStyle(5,o),i.arc(241,241,e,-Math.PI/2,Math.PI*n,!1),a.stage.addChild(i),n>=t?r.stop():n+=.05}),r.start()}var a=new PIXI.Application(482,482,{antialias:!0,backgroundColor:1249574});$(a.view).appendTo($(".chart-left")),o(t[1],47352,236),o(t[0],110737,223),o(t[2],15436545,210),o(t[3],13778070,197)}function d(t,o){var a=echarts.init($(".chart-bottom")[0]),e={backgroundColor:"#131126",title:{text:"一周稿件推荐趋势分析",textStyle:{color:"#fff"},left:40,top:40},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},grid:{left:"63",right:"30",bottom:"30",top:"88",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:o,axisLabel:{textStyle:{color:"#fff"}}}],yAxis:[{type:"value",axisLabel:{textStyle:{color:"#fff"}},splitLine:{show:!1}}],series:[{name:"互联网数据",type:"line",stack:"总量",smooth:!0,lineStyle:{normal:{color:"rgb(0, 184, 248)"}},areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(0, 184, 248,0.4)"},{offset:1,color:"rgba(0, 184, 248,0)"}])}},data:t[1],symbol:"none"},{name:"社内稿件数据",type:"line",stack:"总量",smooth:!0,lineStyle:{normal:{color:"rgb(235, 139, 1)"}},areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba( 235, 139, 1,0.4)"},{offset:1,color:"rgba(235, 139, 1,0)"}])}},data:t[0],symbol:"none"},{name:"行为交易数据",type:"line",stack:"总量",smooth:!0,lineStyle:{normal:{color:"rgb(1, 176, 145)"}},areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(1, 176, 145,0.4)"},{offset:1,color:"rgba(1, 176, 145,0)"}])}},data:t[2],symbol:"none"},{name:"第三方数据",type:"line",stack:"总量",smooth:!0,lineStyle:{normal:{color:"rgb(210, 60, 150)"}},areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(210, 60, 150,0.4)"},{offset:1,color:"rgba(210, 60, 150,0)"}])}},data:t[3],symbol:"none"}]};a.setOption(e)}function f(t,o){o=o||{};var e,r=$(t),n=o.time,l=o.num,i=16*l/(1e3*n),c=0,s=0;e=setInterval(function(){(c+=i)>=l&&(clearInterval(e),e=a,c=l);var t=Math.floor(c);t!=s&&(s=h(t),r.text(s))},16)}function u(t,o){o=o||{};var e,r=$(t),n=o.time,l=o.num,c=16*l/(1e3*n),s=0,d=0;e=setInterval(function(){(s+=c)>=l&&(clearInterval(e),e=a,s=l);var t=Math.floor(s);if(t!=d){d=t;var n;switch(o.type){case"size":n=i(d.toFixed(2));break;case"count":d=h(d),n=g(d)}for(var f=0;f<n.length;f++)$(r.find("li")[f]).text(n.charAt(f))}},16)}function g(t){if(t.length>5)return t;for(;t.length<=5;)t="0"+t;return t=t.substr(0,2)+","+t.substr(3)}function h(t){t=t.toString();return t.replace(/^(\d+)((\.\d+)?)$/,function(t,o,a){return o.replace(/\d{1,3}(?=(\d{3})+$)/g,"$&,")+a})}var p=["internal","external","records","thirdParty"];$.get(Config.api.api1,function(t){if(200==t.code){t=t.data,console.log(t);var o=n(t);d(o.data,o.xAxis),f(".history-count h1",{time:1,num:1*t[0].totalCount.history}),f(".today-count h1",{time:1,num:1*t[0].totalCount.today});c(r(t),t);s(e(t))}}),function(){var t=new PIXI.Application(561,88,{antialias:!0,backgroundColor:1249574});$(t.view).appendTo($(".loading"));for(var o=[{scale:1,color:47352,x:0},{scale:.93,color:174049,x:90},{scale:.86,color:364667,x:175},{scale:.8,color:360304,x:255},{scale:.73,color:9722638,x:329},{scale:.66,color:8343059,x:398},{scale:.6,color:6169425,x:462},{scale:.53,color:4988742,x:522}],a=0;a<o.length;a++)!function(o,a,e){var r=new PIXI.Graphics,n=0;r.beginFill(e),r.drawRoundedRect(0,0,70,88,5),r.beginFill(0),r.drawRect(18,22,40,8),r.drawRect(18,40,40,8),r.drawRect(18,57,30,8),r.scale.x=o,r.scale.y=o,r.x=a,r.y=0,t.stage.addChild(r);var n=o,l=!0;t.ticker.add(function(t){n>=0&&l&&(n-=.01,.2==n.toFixed(2)&&(l=!1)),l||(n+=.01,1==n.toFixed(2)&&(l=!0)),r.clear(),r.beginFill(e),r.drawRoundedRect(0,0,75,88,5),r.beginFill(0),r.drawRect(18,22,40,8),r.drawRect(18,40,40,8),r.drawRect(18,57,30,8),r.scale.x=n,r.scale.y=n})}(o[a].scale,70*a,o[a].color)}()}(window,document);